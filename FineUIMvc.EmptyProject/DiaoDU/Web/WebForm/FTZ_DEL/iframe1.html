<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>iframe1</title>
    <link rel="stylesheet" href="css/common.css" />
    <!--<link rel="stylesheet" href="css/index.css" />-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/dataAnalysis.css" />
    <link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
    <!--<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>-->
    <script src="js/jquery-3.0.0.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.mousewheel.js"></script>
    <script src="js/jquery.mCustomScrollbar.js"></script>
    <script src="js/dataAnalysis.js"></script>
</head>
<body>
    <!-- main start -->
    <div class="main clearfix">
        <div class="main_left">
            <div class="main_left_top">
                <h3 class="pump_title"><span></span></h3>
                <div class="pump_sys clearfix">
                   <div class="type1 clearfix">
                    <!--    <div class="main_box">
                            <div class="main_tube">
                                <div class="pump_text">消防系统</div>
                            </div>
                            <div class="pump_ry pump_r pump_r1">
                                <div class="pump_status1"></div>
                            </div>
                           
                            // side_tube 
                            <div class="side_tube">
                                <div class="side_tube_left"></div>
                                <div class="side_tube_bottom">
                                    <div class="bottom_left"></div>
                                </div>
                                <div class="manometer manometer2"></div>
                            </div>

                            
                            
                           
                            
                           // branch_r
                            <div class="branch_r clearfix">
                                <div class="branch_r_left"></div>
                                <div class="branch_r_right"></div>
                                <div class="pump_ry pump_r">
                                    <div class="pump_status1"></div>
                                </div>
                                <div class="branch_r_bottom">
                                    <div class="branch_r_bottomLeft"></div>
                                    <div class="branch_r_bottomRight"></div>
                                </div>

                            </div>
                            // branch_r end

                            
                           // branch_y /
                            <div class="branch_y">
                                <div class="branch_y_left"></div>
                                <div class="branch_y_right"></div>
                                <div class="pump_ry pump_y">
                                    <div class="pump_status1"></div>
                                </div>
                                <div class="branch_y_bottom">
                                    <div class="branch_y_bottomLeft"></div>
                                    <div class="branch_y_bottomRight"></div>
                                </div>

                            </div>
                            //branch_y end
                            



                            <div class="arrow arrow1"></div>
                            <div class="manometer manometer1"></div>

                        </div>
 -->
                    </div>
     
                   
                    <div class="type1 clearfix">
                        

                    </div>
                    <div class="type2">
                       <!-- <div class="blue_main">
                            <div class="blue_main_tube">
                                <div class="pump_text">消防系统</div>
                            </div>
                            <div class="pump_b pump_b1">
                                <div class="pumpb_status"></div>
                            </div>
                            <div class="blue_side_tube1">
                                <div class="blue_side_right"></div>
                            </div>
                            <div class="blue_side_tube2">
                                <div class="blue_side_right"></div>
                            </div>
                            <div class="arrow arrow2"></div>
                            <div class="water_tank water_tank1">
                                <div class="water_container">
                                    <div class="water_water"></div>
                                </div>
                            </div>

                            <div class="water_tank water_tank2">
                                <div class="water_container">
                                    <div class="water_water"></div>
                                </div>
                            </div>
                            <div class="branch_b clearfix">
                                <div class="branch_b_left"></div>
                                <div class="branch_b_right"></div>
                                <div class="pump_b">
                                    <div class="pumpb_status"></div>
                                </div>
                                <div class="branch_b_bottom">
                                    <div class="branch_b_bottomLeft"></div>
                                    <div class="branch_b_bottomRight"></div>
                                </div>

                            </div>

                        </div>-->
                    </div>
                    <div class="type3 clearfix">
                        <!--<div class="pump_out">
                            <div class=" pump_out1 pumpOut">
                                <div class="pump_status2"></div>
                            </div>
                            <div class="pump_out2 pumpOut">
                                <div class="pump_status2 "></div>
                            </div>
                            
                        </div>-->
                    </div>
                </div>

            </div>
            <div class="main_left_bottom">
                <div class="toggle_table">
                    <div class="direction up"></div>
                    <div class="text">历史记录</div>
                </div>
                <div class="form_box hide">
                    <table>
                        <thead>
                            <tr class="border">
                                <th>采集时间</th>
                                <th>生活泵状态</th>
                                <th>消防泵状态</th>
                                <th>喷淋泵状态</th>
                                <th>消防出水压力</th>
                                <th>喷淋出水压力</th>
                            </tr>
                        </thead>
                            
                        <tbody>
                           <!-- <tr>
                                <td class="createTime">2016-8-25 12:34:28</td>
                                <td class="pumpSt lifeSt">
                                    <span class="state status3"></span>
                                    <span class="state status2"></span>
                                    <span class="state status1"></span>
                                </td>
                                <td class="pumpSt fireSt">
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                </td>
                                <td class="pumpSt spraySt">
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                </td>
                                <td class="pumpPr firePr" >
                                    <span class="press">0.24</span>
                                    <span class="press">0.28</span>
                                    <span class="press">0.56</span>
                                </td>
                                <td class="pumpPr sprayPr">
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                </td>
                            </tr>
                            <tr>
                                <td>2016-8-25 12:34:28</td>
                                <td>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                </td>
                                <td>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                </td>
                                <td>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.28</span>
                                    <span class="press">0.56</span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                </td>
                            </tr>
                            <tr>
                                <td>2016-8-25 12:34:28</td>
                                <td>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                </td>
                                <td>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                </td>
                                <td>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.28</span>
                                    <span class="press">0.56</span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                </td>
                            </tr>
                            <tr>
                                <td>2016-8-25 12:34:28</td>
                                <td>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                </td>
                                <td>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                </td>
                                <td>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.28</span>
                                    <span class="press">0.56</span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                </td>
                            </tr>
                            <tr>
                                <td>2016-8-25 12:34:28</td>
                                <td>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                </td>
                                <td>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                    <span class="state run"></span>
                                </td>
                                <td>
                                    <span class="state run"></span>
                                    <span class="state"></span>
                                    <span class="state error"></span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.28</span>
                                    <span class="press">0.56</span>
                                </td>
                                <td>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                    <span class="press">0.24</span>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                    <span class="press">0.24</span>
                                    <span class="press">0.24</span>
                                    <span class="press">0.27</span>
                                    <span class="press">0.58</span>
                                    <span class="press">0.24</span>
                                </td>
                            </tr>-->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="main_right">
            <div class="fireBox">
                <!--<div class="sys_box fire">
                    <div class="sys_header">
                        <h4>消防系统</h4>
                        <span></span>
                    </div>
                    <ul class="sys_list">
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                    </ul>
                </div>-->
            </div>
            <div class="sprayBox">
                <!--<div class="sys_box spray">
                    <div class="sys_header">
                        <h4>喷淋系统</h4>
                        <span></span>
                    </div>
                    <ul class="sys_list">
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                    </ul>
                </div>-->
            </div>
            <div class="lifeBox">
               <!-- <div class="sys_box life">
                    <div class="sys_header">
                        <h4>生活系统</h4>
                        <span></span>
                    </div>
                    <ul class="sys_list">
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                        <li><p>水箱水位</p><span>1234560</span></li>
                    </ul>
                </div>-->
            </div>           
        </div>
        <div class="logo_big"></div>
    </div>

    <!-- main end -->

    <div id="footer" class="footer clearfix" style=" position:fixed;bottom:0;left:0;">
        <div class="footer_left">
            <div class="horn"></div>
            <ul class="left_list">
                <li><a href="#"><span class="alarm_time">2016-8-25 12:37:24</span> <span class="alarm_text">喷淋系统管路压力超高报警</span></a></li>
                <li><a href="#">2016-8-25 12:37:24 系统管路压力超高报警</a></li>
                <li><a href="#">2016-8-25 12:37:24 喷淋系统管路压力超高报警</a></li>
                <li><a href="#">2016-8-25 12:37:24 系统管路压力超高报警</a></li>
                <li><a href="#">2016-8-25 12:37:24 喷淋系统管路压力超高报警</a></li>
            </ul>
        </div>        
        <div class="footer_right clearfix">
            <div class="get clearfix">
                <p>采集: <span> 2016-8-27 12:48:14</span></p>
            </div>
            <div class="system clearfix">
                <p>系统: <span> 2016-8-27 12:48:14</span></p>
            </div>
        </div>
        <div class="footer_mid">
            <span></span>
        </div>
    </div>
    
    <!-- footer end -->
    
    <script>
        
        $(function () {

            function parseUrl() {

                var url = window.location.href;
                 alert(url);
                var i = url.indexOf('?');
                 alert(1);
                if (i == -1) { return };
                var queryStr = url.substr(i + 1);
                var arr1 = queryStr.split('&');
                var arr2 = {};
                for (j in arr1) {
                    var tar = arr1[j].split('=');

                    arr2[tar[0]] = tar[1];
                };
                // alert(0);
                // alert(arr2);
                return arr2;


            }
            var v = parseUrl();
            alert(v);





            // 泵房右侧 的 模块(暂时 无数据)
            //右侧模块处理函数
            function sysStatic(data, j) {
                var sysData = data.data[j];
                var sysF = [];
                var sysS = [];
                var sysL = [];

                //生活 系统压力设置
                sysL[0] = sysData['F40002'];
                sysL[1] = sysData['F40005'];
                sysL[2] = sysData['F40006'];
                sysL[3] = sysData['F40007'];

                //消防系统 压力设置
                //sysF[0] = sysData['F40041'];

                //喷淋系统 压力设置
                //sysS[0] = sysData['F40056'];


                return { 'a': sysF, 'b': sysS, 'c': sysL };
            }

            //右侧模块 刷新函数
            function sysStatus(data, j) {
                //var sysStatF = sysStatic(data, j)['a'];
                //var sysStatS = sysStatic(data, j)['b'];
                var sysStatL = sysStatic(data, j)['c'];

               // var statusF = ['手动','自动'];
                //var statusS = ['手动','自动'];
                var statusL = ['手动','自动','','停止'];
                var statusFA = ['出水设定压力', '出水实际压力', '进水实际压力'];

                /*if ($('.sys_box.fire')) {
                    $('.sys_box.fire .sys_list').empty().append('<li><p>消防系统状态</p><span>' + statusF[sysStatF[0]] + '</span></li>');

                } 
                if ($('.sys_box.spray')) {
                    $('.sys_box.spray .sys_list').empty().append('<li><p>喷淋系统状态</p><span>' + statusS[sysStatS[0]] + '</span></li>');
                }*/
                if ($('.sys_box.life')) {
                    $('.sys_box.life .sys_list').empty().append('<li><p>生活系统状态</p><span>' + statusL[sysStatL[0]] + '</span></li>');
                    var str = '';
                    for (i = 1; i <sysStatL.length; i++) {
                        str += '<li><p>' + statusFA[i-1] + '</p><span>' + sysStatL[i] + '</span></li>';
                    }
                    $('.sys_box.life .sys_list').append(str);
                }
            }
            //泵房下边的  历史记录列表
            (function () {
                $('.direction').click(function () {
                    if ($(this).hasClass('up')) {
                        return;
                    }
                    getHisLis();
                });
                //左下角的 历史记录 点击 触发历史列表
                $('.toggle_table .text').click(function () {
                    
                    $('.direction').trigger('click');
                });
                var hisTimer = null;
                hisTimer = setInterval(function () {
                    if ($('.direction').hasClass('up')) {
                        return;
                    } else {
                        getHisLis();
                    }
                }, 1000*120);
              //左下角的 历史记录的 生成函数
                function getHisLis() {
                    $.ajax({
                        url: '../../Service/T_DataService.ashx?method=search',
                        data: { 'FPumpID': v['id'], 'pageIndex': 0, 'pageSize': 5 },
                        cache: false,
                        success: function (data) {
                            //console.log(data);
                            $('.form_box tbody').empty();
                            var data = JSON.parse(data);
                            $.each(data.data, function (i, v) {
                                //console.log(pressHis(data, i)['strFp']);
                                //console.log(pumpHis(data, i).strFm);strLm
                                var FCreateDate = v.FCreateDate ? v.FCreateDate.replace('T', ' ') : "无获取";
                                $('.form_box tbody').append('<tr><td class="createTime">' + FCreateDate +'</td><td class="pumpSt lifeSt">' + pumpHis(data, i).strLm + '</td><td class="pumpSt fireSt">' + pumpHis(data, i).strFm + '</td><td class="pumpSt spraySt">' + pumpHis(data, i).strSm + '</td><td class="pumpPr firePr" >' + pressHis(data, i).strFp + '</td><td class="pumpPr sprayPr">' + pressHis(data, i).strSp + '</td></tr>');

                            });
                           

                            /* $.each(data.data, function (i, v) {
                                 $('#footer .left_list').append('<li><a href="javascript:void(0);"><span class="alarm_time">' + v.FAlarmDate + '</span> <span class="alarm_text">' + v.FContent + '</span></a></li>');
                             });*/
                        },
                        error: function (data) {
                            if (window.console) {
                                console.log('错误：' + data.responseText);
                            }                    
                        }
                    });
                };
                
            })();
       
            // 压力值处理函数
            function pressStatic(data,j) {
                var pressData = data.data[j];

                var pressFS = [];
                var pressSS = [];
                //var pressLS = [];
                //消防泵压力 
                pressFS[0] = pressData['F40081'];
                pressFS[1] = pressData['F40082'];
                pressFS[2] = pressData['F40083'];
                pressFS[3] = pressData['F40084'];
                //喷淋泵压力
                pressSS[0] = pressData['F40071'];
                pressSS[1] = pressData['F40072'];
                pressSS[2] = pressData['F40073'];
                pressSS[3] = pressData['F40074'];
                pressSS[4] = pressData['F40075'];
                pressSS[5] = pressData['F40076'];
                pressSS[6] = pressData['F40077'];
                pressSS[7] = pressData['F40078'];
                pressSS[8] = pressData['F40079'];
                pressSS[9] = pressData['F40080'];
                pressSS[10] = pressData['F40069'];
                pressSS[11] = pressData['F40070'];
                //生活泵压力
                // pressFS[0] = pressData['F40081'];
                // pressFS[0] = pressData['F40081'];
                // pressFS[0] = pressData['F40081'];
                // pressFS[0] = pressData['F40081'];
                // pressFS[0] = pressData['F40081'];
                //pressFS[0] = pressData['F40081'];
                return { 'a': pressFS, 'b': pressSS };
            }

            // 历史记录中压力值状态 显示
            function pressHis(data,j) {
                var pressFS = pressStatic(data,j)['a'];
                var pressSS = pressStatic(data,j)['b'];
                var strFP = '';
                var strSP = '';
                var outSetFireLen = $('.main_left_top .type1').eq(0).find('.manometer').length;
                var outSetSprayLen = $('.main_left_top .type1').eq(1).find('.manometer').length;
                
                for (k = 0; k < outSetFireLen; k++) {
                        strFP += '<span class="press">' + pressFS[k] + '</span>';
                    
                    
                };
                for (l = 0; l < outSetSprayLen; l++) {
                        strSP += '<span class="press">' + pressSS[l] + '</span>';
                   
                    
                };
                return { 'strFp': strFP, 'strSp': strSP };

            }
            //刷新压力值的状态
            function pressStatus(data,j) {    
               
               
                var pressFS = pressStatic(data,j)['a'];
                var pressSS = pressStatic(data,j)['b'];
                //<span class="current">0</span><span class="standard">.45</span>
                //$('.pump_sys .type1').eq(0).find('.manometer').length+'dddfffdsfsdfsafsa');
                var rym1 = $('.pump_sys .type1').eq(0).find('.manometer .current');
                var rym2 = $('.pump_sys .type1').eq(1).find('.manometer .current');
                var bm = $('.pump_sys .type2').eq(0).find('.manometer .current');
                //var rymLen1 = rym1.length;
                //var rymLen2 = rym2.length;
                //var bmLen = bm.length;
               // console.log("haha" + pressFS[1] + "<br>" + pressSS[1] + "heihei");
               // console.log("haha" + pressFS + "<br>" + pressSS + "heihei");
                //console.log(rymLen1 + "" + rymLen2 + "" + bmLen);

                //右侧新改压力 处理
                if ($('.sys_box.fire')) {
                    $('.sys_box.fire .sys_list').empty();

                }
                if ($('.sys_box.spray')) {
                    $('.sys_box.spray .sys_list').empty();
                }
                rym1.each(function (i, v) {
                    $(this).html(pressFS[i]);
                    //右侧  新改 压力显示
                    $('.sys_box.fire .sys_list').append('<li><p>出水' + (i+1) + '号压力</p><span>' + pressFS[i] + '</span></li>');
                });
                rym2.each(function (i, v) {
                    $(this).html(pressSS[i]);
                    //右侧  新改 压力显示
                    $('.sys_box.spray .sys_list').append('<li><p>出水' + (i + 1) + '号压力</p><span>' + pressSS[i] + '</span></li>');
                });
               /* bm.each(function (i, v) {
                    $(this).html(pressLS[i]);
                });*/

            }
            //Dewater处理函数
            function pumpDewater(data, j) {
                var DewaterData = data.data[j];
                var pumpDewat = [];

                pumpDewat[0] = DewaterData['F40095'];
                pumpDewat[1] = DewaterData['F40096'];

                return pumpDewat;
            };
            //Dewater刷新函数

            function pumpDewatStatus(data, j) {
                var pumpDewat = pumpDewater(data, j);
                //dewater
                var de = $('.pump_sys .type3').eq(0).find('.pump_out div div');
                de.each(function (i, v) {
                    
                    $(this).removeClass(function (j, va) {
                        var exp = /^pump_status[0-3]/;//[1-3]
                        var remove = va.match(exp);
                        //alert(typeof String(remove));
                        return String(remove);
                    }).addClass('pump_status' + pumpDewat[i]);// Math.ceil(Math.random() * 3)
                });
            }

            //泵状态的处理函数
            function pumpStatic(data,j) {
                var pumpData = data.data[j];
                var pumpFS = [];
                var pumpSS = [];
                var pumpLS = [];
                // 消防泵的状态
                pumpFS[0] = pumpData['F40044'];
                pumpFS[1] = pumpData['F40045'];
                pumpFS[2] = pumpData['F40046'];
                pumpFS[3] = pumpData['F40047'];
                pumpFS[4] = pumpData['F40048'];
                pumpFS[5] = pumpData['F40049'];
                //喷淋泵的状态
                pumpSS[0] = pumpData['F40059'];
                pumpSS[1] = pumpData['F40060'];
                pumpSS[2] = pumpData['F40061'];
                pumpSS[3] = pumpData['F40062'];
                pumpSS[4] = pumpData['F40063'];
                //生活泵的状态
                pumpLS[0] = pumpData['F40008'];
                pumpLS[1] = pumpData['F40009'];
                pumpLS[2] = pumpData['F40010'];
                pumpLS[3] = pumpData['F40011'];
                pumpLS[4] = pumpData['F40012'];
                pumpLS[5] = pumpData['F40013'];

                return {'a':pumpFS,'b':pumpSS,'c':pumpLS};
            }
            //历史记录中泵状态的显示 
            function pumpHis(data, j) {
                var pumpFS = pumpStatic(data,j)['a'];
                var pumpSS = pumpStatic(data,j)['b'];
                var pumpLS = pumpStatic(data,j)['c'];

                var strFM = '';
                var strSM = '';
                var strLM = '';

                for (var k = 0; k < pumpFS.length; k++) {
                    if (pumpFS[k] != 0) {
                        strFM += '<span class="state status' + pumpFS[k] + '"></span>';
                    }
                };
                for (var l = 0; l < pumpSS.length; l++) {
                    if (pumpSS[l] != 0) {
                        strSM += '<span class="state status' + pumpFS[l] + '"></span>';
                    }
                };
                for (var m = 0; m < pumpLS.length; m++) {
                    if (pumpLS[m] != 0) {
                        strLM += '<span class="state status' + pumpFS[m] + '"></span>';
                    }
                };
                var len = pumpFS.length + pumpSS.length + pumpLS.length;
                return { 'strFm': strFM, 'strSm': strSM, 'strLm': strLM,'lenth':len };

            }
            //刷新泵的显示状态
            function pumpStatus(data, j) {

                var pumpFS = pumpStatic(data, j)['a'];
                var pumpSS = pumpStatic(data, j)['b'];
                var pumpLS = pumpStatic(data, j)['c'];
                //console.log(pumpFS);
                // console.log(pumpSS);
                //console.log(pumpLS);
                // console.log($('.pump_sys .type1').eq(0).find('.pump_ry').length + "dddddddddddaaaaaaa");
                var ry1 = $('.pump_sys .type1').eq(0).find('.pump_ry div');
                var ry2 = $('.pump_sys .type1').eq(1).find('.pump_ry div');
                var b = $('.pump_sys .type2').eq(0).find('.pump_b div');

                //var ryLen1 = ry1.length;
                //var ryLen2 = ry2.length;
                // var bLen = b.length;
                //console.log(ryLen1 + "" + ryLen2 + "" + bLen);
                //console.log(pumpFS + "atong" + pumpSS + "yiKU" + pumpLS+"alieatong");
                ry1.each(function (i, v) {
                    $(this).removeClass().addClass('pump_status' + pumpFS[i]);
                });
                ry2.each(function (i, v) {
                    $(this).removeClass().addClass('pump_status' + pumpSS[i]);
                });
                b.each(function (i, v) {
                    $(this).removeClass().addClass('pump_status' + pumpLS[i]);
                });


            };
            //hover  显示最小最大压力值
            function showMaxMin() {
                $('.manometer .current').mouseenter(function (e) {                   
                    var x=-40;
                    var y=18;
                    var toolTip = '<div id="toolTip" style="position: absolute;padding:1px 14px;width:120px;border-radius: 5px;color: white; background: rgba(0,0,0,.6);font-size: 12px;">' + $(this).next().html() + '<br>上限: ' + Number($(this).next().attr('Max')) +' 下限: '+ Number($(this).next().attr('Min')) + '</div>';
                    $('body').append(toolTip);
                    $('#toolTip').css({
                        'top': (e.pageY + y) + "px",
                        'left': (e.pageX + x) + "px"
                    }).show("fast");
                }).mouseout(function () {
                    $('#toolTip').remove();;
                    //alert($(this).html());
                });
            }
           
           
            //  获取  最大 最小压力 和名字的函数
            function getMaxMin() {            
                  
                            var currentNameLenR1 = $('.pump_sys .type1').eq(0).find('.manometer .currentName');
                            currentNameLenR1.each(function (i, va) {
                                var that = $(this);
                                $.ajax({
                                    url: '../../Service/T_OutSetService.ashx?method=search',
                                    async: false,
                                    cache: false,
                                    data: {
                                        'FPumpID': v['id'],
                                        'FType': '消防',
                                        'FIndex':i+1
                                    },
                                    success: function (data) {
                                       // console.log(data);
                                        var data = JSON.parse(data);
                                        data = data.data[0];
                                      
                                        var FMax = data.FMax ? data.FMax : 0;
                                        var FMin = data.FMin ? data.FMin : 0;
                                            that.html(data.FName);
                                            that.attr('Max', FMax);
                                            that.attr('Min', FMin);
                                    },
                                    error: function (data) {
                                        if (window.console) {
                                            console.log("error11" + data);
                                        }                                        
                                    }
                                });
                            });


                            var currentNameLenR2 = $('.pump_sys .type1').eq(1).find('.manometer .currentName');
                           // console.log(currentNameLenR2.length);
                            currentNameLenR2.each(function (i, va) {
                                var that = $(this);
                                $.ajax({
                                    url: '../../Service/T_OutSetService.ashx?method=search',
                                    async: false,
                                    cache: false,
                                    data: {
                                        'FPumpID': v['id'],//1
                                        'FType': '喷淋',
                                        'FIndex': i + 1
                                    },
                                    success: function (data) {
                                        //console.log(data);
                                        var data = JSON.parse(data);
                                        data = data.data[0];

                                        var FMax = data.FMax ? data.FMax : 0;
                                        var FMin = data.FMin ? data.FMin : 0;
                                        that.html(data.FName);
                                        that.attr('Max', FMax);
                                        that.attr('Min', FMin);
                                    },
                                    error: function (data) {
                                        if (window.console) {
                                            console.log("error" + data);
                                        }
                                        
                                    }
                                });
                            });
                            //var currentNameLenB = $('.pump_sys .type2').eq(0).find('.manometer .currentName').html('dddd');
                      /*  },
                        error: function(data){
                            alert("error"+data);
                        }
                    });*/
              
            };
            // 定时获取新数据
            function getNewData(){
                var timer = null;
                timer = setInterval(getCurrentData, 3000);
            }
            //获取实时 数据
            function getCurrentData() {
                
                $.ajax({
                    url: '../../Service/T_DataMainService.ashx?method=getcurrentdata',
                    data: { 'FPumpID': v['id'] },
                    async: false,
                    cache:false,
                    success: function (data) {
                        //console.log(data);
                        var data = JSON.parse(data);
                        //console.log($('.pump_sys .type1').eq(0).find('.pump_ry').length + "dddddddddddaaaaaaa");
                        $('.main_left_top .pump_title span').removeClass().addClass("status" + data.FIsOnline + "");
                        $('.footer_right .system span').html(data.serverTime);
                        $('.footer_right .get span').html(data.data[0].FCreateDate);

                        pumpStatus(data,0);
                        pressStatus(data, 0);
                        pumpDewatStatus(data, 0);
                        //新增右侧 各个系统
                        sysStatus(data, 0);
                        //console.log($('.pump_sys .type1').eq(0).find('.manometer').length+'dddfffdsfsdfsafsa');

                    },
                    error: function (data) {
                        if (window.console) {
                            console.log('error' + data.responseText);
                        }                        
                    }
                });
            };
            
           /* $('body').click(function () {
                alert(1);
                $.ajax({
                    url: '../../Service/T_DataMainService.ashx?method=getcurrentdata',
                    data:{'FPumpID':12},
                    cache:false,
                    success: function (data) {
                        console.log(data);
                    }
                });
            });*/

           /*
            (function () {
                $('#footer .footer_left').ready(function () {
                    get_alarm();
                });
                var len = 0;
                var timer = null;
                var num = 0;
                var h = $('.footer_left').height();
                function upDate_list() {
                    $('.footer_left ul').animate({ top: -(h * num) + "px" }, 2000);
                    if (num == len - 1) {
                        //num = len - 1;
                        clearInterval(timer);
                        if (len > 1) {
                            $('#footer .left_list').empty();
                        }
                        //$('#footer .left_list').empty();
                        if (!$('#footer .left_list').html()) {
                            
                            setTimeout(function () {
                                num = 0;
                                //alert(1);
                                //alert(0);
                                get_alarm();
                            }, 2000);
                           
                        }

                    } else {
                        num++;
                    }
                };
                function alarm_his_loop() {
                    // clearInterval(timer);

                    len = $('.footer_left ul li').length;
                    //upDate_list();
                    timer = setInterval(upDate_list, 2000);
                   
                };
                function get_alarm() {
                    $('#footer .left_list').html('');
                    $.ajax({
                        url: '../../Service/T_AlarmService.ashx?method=searchall',
                        data: { 'FPumpID': v['id'] },
                        cache:false,
                        success: function (data) {
                            // console.log(data);

                            //console.log($('#footer .left_list').html()+"sdfsalfjfasljfalsfjsfj");
                            var data = JSON.parse(data);
                            $.each(data.data, function (i, v) {
                                $('#footer .left_list').append('<li><a href="javascript:void(0);"><span class="alarm_time">' + v.FAlarmDate + '</span> <span class="alarm_text">' + v.FContent + '</span></a></li>');
                            });
                            

                        },
                        complete: function () {
                            alarm_his_loop();
                        },
                        error: function (data) {
                            alert('错误：' + data.responseText);
                        }
                    });

                };
            })();
            

            */

            //获取小喇叭报警信息改写
            (function () {
                var $this = $('.footer_left');
                var scrollTimer;
                var get_alerm_timer;
                $this.hover(function () {
                    clearInterval(scrollTimer);
                },
                function () {
                    scrollTimer = setInterval(function () {
                        alerm_loop($this);
                    }, 2000);
                }
                ).trigger('mouseout');

                //报警 滚动动画
                function alerm_loop(obj) {
                    var $self = obj.find("ul:first");
                    var lineHeight = $self.find("li:first").height();

                    $self.animate({ "margin-top": -lineHeight + "px" }, 900, function () {
                        $self.css("margin-top", "0px").find("li:first").appendTo($self);
                    });
                };

                setInterval(function () {
                    get_alarm();
                },1000*60);
                //获取 报警的信息
                get_alarm();
                function get_alarm() {
                    $('#footer .left_list').html('');
                    $.ajax({
                        url: '../../Service/T_AlarmService.ashx?method=searchall',
                        data: { 'FPumpID': v['id'] },//v['id']
                        cache: false,
                        success: function (data) {
                            // console.log(data);

                            //console.log($('#footer .left_list').html()+"sdfsalfjfasljfalsfjsfj");
                            var data = JSON.parse(data);
                            if (data['total'] != 0) {
                                $.each(data.data, function (i, v) {
                                    var FAlarmDate = v.FAlarmDate ? v.FAlarmDate.replace("T", " ") : "无数据";
                                    $('#footer .left_list').append('<li><a href="javascript:void(0);"><span class="alarm_time">' + FAlarmDate + '</span> <span class="alarm_text">' + v.FContent + '</span></a></li>');
                                });
                            }             
                        },
                     
                        error: function (data) {
                            if (window.console) {
                                console.log('错误：' + data.responseText);
                            }                           
                        }
                    });

                };
            })();
            

            /*var aleam_loop_timer = null;
            aleam_loop_timer = setInterval(function () {
                // if(){}
                get_alarm();
            }, 6000);*/
            

            //createUrl
            /*(function () {
                function createUrl(url, current_id) {
                    return url + '?id=' + current_id + '&v=' + Math.random();
                }
            })();
            */

            //parseUrl function
      





            //获取历史记录

           /*(function () {
               $('body').click(function () {
                   $.ajax({
                       url: '../../Service/T_AlarmHistoryService.ashx?method=get',
                       data: { "key": "id like '%v['id']%'","pageIndex":0,"pageSize":10 },
                       cache:false,
                       success: function (data) {
                           alert('COOL');
                           console.log(data);
                       }
                   });
               });
           })();*/



           

            //根据 传入的ID 获取相应的泵
           (function () {
               $.ajax({
                   url: '../../Service/PumpManagerService.ashx?method=get',
                   data: { 'id': v['id'] },
                   async: false,
                   cache: false,
                   success: function (data) {
                       //console.log(data);

                       var $fireBox = $('.main_right .fireBox').eq(0);
                       var $sprayBox = $('.main_right .sprayBox').eq(0);
                       var $lifeBox = $('.main_right .lifeBox').eq(0);
                       $fireBox.empty();
                       $sprayBox.empty();
                       $lifeBox.empty();

                       var data = JSON.parse(data);
                       $('.main_left_top .pump_title span').addClass('status' + data.FIsOnline).after(data.FName);

                       //新添加的地址信息
                       $('.footer .footer_mid span').html(data.FAddress);
                       function fireLoad(data) {
                           
                           if (data.FFireMajorPumpNum || data.FFireAuxPumpNum) {
                               var numM = data.FFireMajorPumpNum;
                               var numA = data.FFireAuxPumpNum;
                               var numFO = data.FFireOutNum;
                               var str_r = "";
                               var str_y = "";
                               var str_O = "";
                               for (i = 1; i < numM; i++) {
                                   str_r += '<div class="branch_r clearfix"><div class="branch_r_left"></div><div class="branch_r_right"></div><div class="pump_ry pump_r"><div class="pump_status"></div></div><div class="branch_r_bottom"><div class="branch_r_bottomLeft"></div><div class="branch_r_bottomRight"></div></div></div>'
                               };
                               for (j = 0; j < numA; j++) {
                                   str_y += '<div class="branch_y"><div class="branch_y_left"></div><div class="branch_y_right"></div><div class="pump_ry pump_y"><div class="pump_status"></div></div><div class="branch_y_bottom"><div class="branch_y_bottomLeft"></div><div class="branch_y_bottomRight"></div></div></div>'
                               };
                               for (k = 1; k < numFO; k++) {
                                   str_O += '<div class="side_tube"><div class="side_tube_left"></div><div class="side_tube_bottom"><div class="bottom_left"></div></div><div class="manometer manometer2"><div><span class="current">0</span><i class="currentName"></i></div></div></div>'
                               }
                               $('.pump_sys .type1').eq(0).empty().html('<div class="main_box"><div class="main_tube"><div class="manometer manometer1"><div><span class="current">0</span><i class="currentName"></i></div></div><div class="pump_text">消防系统</div></div><div class="pump_ry pump_r pump_r1"><div class="pump_status"></div></div>' + str_r + str_y + str_O + '<div class="arrow arrow1"></div></div>');
                               $('.main_right .fire').eq(0).empty();
                               //右侧 消防状态框的 显示
                               $fireBox.empty().html('<div class="sys_box fire"><div class="sys_header"><h4>消防系统</h4><span></span></div><ul class="sys_list"></ul></div>');//<li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li> 10月25 delete
                                

                           }
                       };
                       function sprayLoad(data) {
                           if (data.FSprayMajorPumpNum || data.FSprayAuxPumpNum) {
                               var numM = data.FSprayMajorPumpNum;
                               var numA = data.FSprayAuxPumpNum;
                               var numFO = data.FSprayOutNum;
                               var str_r = "";
                               var str_y = "";
                               var str_O = "";
                               for (i = 1; i < numM ; i++) {
                                   str_r += '<div class="branch_r clearfix"><div class="branch_r_left"></div><div class="branch_r_right"></div><div class="pump_ry pump_r"><div class="pump_status"></div></div><div class="branch_r_bottom"><div class="branch_r_bottomLeft"></div><div class="branch_r_bottomRight"></div></div></div>'
                               };
                               for (j = 0; j < numA; j++) {
                                   str_y += '<div class="branch_y"><div class="branch_y_left"></div><div class="branch_y_right"></div><div class="pump_ry pump_y"><div class="pump_status"></div></div><div class="branch_y_bottom"><div class="branch_y_bottomLeft"></div><div class="branch_y_bottomRight"></div></div></div>'
                               };
                               for (k = 1; k < numFO; k++) {
                                   str_O += '<div class="side_tube"><div class="side_tube_left"></div><div class="side_tube_bottom"><div class="bottom_left"></div></div><div class="manometer manometer2"><div><span class="current">0</span><i class="currentName"></i></div></div></div>'
                               }
                               $('.pump_sys .type1').eq(1).empty().html('<div class="main_box"><div class="main_tube"><div class="manometer manometer1"><div><span class="current">0</span><i class="currentName"></i></div></div><div class="pump_text">喷淋系统</div></div><div class="pump_ry pump_r pump_r1"><div class="pump_status"></div></div>' + str_r + str_y + str_O + '<div class="arrow arrow1"></div></div>');

                               //右侧 喷淋状态框的 显示
                               $sprayBox.empty().html('<div class="sys_box spray"><div class="sys_header"><h4>喷淋系统</h4><span></span></div><ul class="sys_list"></ul></div>');//<li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li>

                           }
                       };
                       function lifeLoad(data) {
                           if (data.FLifeMajorPumpNum || data.FLifeAuxPumpNum) {
                               var numM = data.FLifeMajorPumpNum;
                               var numA = data.FLifeAuxPumpNum;
                               var numFO = data.FLifeOutNum;
                               var str_b = "";

                               for (i = 1; i < numM+numA; i++) {
                                   str_b += '<div class="branch_b clearfix"><div class="branch_b_left"></div><div class="branch_b_right"></div> <div class="pump_b"><div class="pumpb_status"></div></div><div class="branch_b_bottom"><div class="branch_b_bottomLeft"></div><div class="branch_b_bottomRight"></div></div></div>'
                               };
                               $('.pump_sys .type2').eq(0).empty().html('<div class="blue_main"><div class="blue_main_tube"><div class="pump_text">生活系统</div> </div><div class="pump_b pump_b1"><div class="pumpb_status"></div></div> <div class="blue_side_tube1"><div class="blue_side_right"></div></div><div class="blue_side_tube2"><div class="blue_side_right"></div></div><div class="arrow arrow2"></div><div class="water_tank water_tank1"><div class="water_container"><div class="water_water"></div></div></div><div class="water_tank water_tank2"><div class="water_container"><div class="water_water"></div></div></div>' + str_b + '</div>')

                               //右侧 生活状态框的 显示
                               $lifeBox.empty().html('<div class="sys_box life"><div class="sys_header"><h4>生活系统</h4><span></span></div><ul class="sys_list"></ul></div>');//<li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li><li><p>水箱水位</p><span>1234560</span></li>
                           }
                       };
                       //右下角添加的泵
                       function deWaterLode(data) {
                           if (data.FDewaterPumpNum) {
                               var numFD = data.FDewaterPumpNum;
                              // alert(numFD);
                               $('.pump_sys .type3').eq(0).empty().html('<div class="pump_out"> <div class=" pump_out1 pumpOut"><div class="pump_status2"></div></div><div class="pump_out2 pumpOut"> <div class="pump_status2 "></div></div></div>');
                           }
                       };
                       fireLoad(data);
                       sprayLoad(data);
                       lifeLoad(data);
                       deWaterLode(data);
                       side_tube_load();
                       getMaxMin();
                       showMaxMin();
                       getCurrentData();

                       getNewData();

                   },
                   error: function (data) {
                       if (window.console) {
                           console.log('error' + data);
                       }                     
                   }
               });
           })();
            
        })
       


        //动态加载页面后side_tube的加载   
        function side_tube_load() {
            var $tube_parent = $('.main_left_top .type1');
            var $tube_parent_main_tube = $('.main_left_top .type1 .main_tube');
            var $all_parent_length = $tube_parent.length;
            var $tube_parent_main_tube_length = $tube_parent_main_tube.length;
            //alert($all_parent_length+'love');
            var $all_tube_length = $tube_parent.find('.side_tube').length;
            //alert($all_tube_length+'you');
            var $all_branch_length = $tube_parent.find('.branch_r').length;
            if ($tube_parent_main_tube_length == 2 && $all_tube_length <= 2) {
                $('.main_left_top .pump_sys .type2 .blue_main').css('margin-top', ($all_tube_length + 2) * 30 + 'px');
            } else if ($tube_parent_main_tube_length == 1 && $all_branch_length<2 && $all_tube_length <= 2) {
                $('.main_left_top .pump_sys .type2 .blue_main').css('margin-top', ($all_tube_length + 2) * 30 + 120 + 'px');
            } else if ($tube_parent_main_tube_length == 0 && $all_tube_length <= 2) {
                $('.main_left_top .pump_sys .type2 .blue_main').css('margin-top', ($all_tube_length + 2) * 30 + 220 + 'px');
            }
            $tube_parent.each(function (i) {
                var $tube = $(this).find('.side_tube');
                var len = $tube.length;
                //alert(len+'me');                         
                $(this).find('.main_box').css('padding-bottom', len * 36 + 'px'); //27
                
                $tube.each(function (j) {
                    $(this).addClass('side_tube' + j);
                    // alert($(this).css('top'));
                    $(this).css('top', parseInt($(this).css('top')) + j * 70 + 'px');
                });
            });
        };
    </script>
</body>
</html>